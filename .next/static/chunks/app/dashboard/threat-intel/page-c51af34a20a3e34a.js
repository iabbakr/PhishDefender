(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[819],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>d,r:()=>o});var r=s(5155),a=s(2115),n=s(4253),i=s(2085),l=s(9434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:s})),ref:t,...c})});d.displayName="Button"},2437:(e,t,s)=>{"use strict";s.d(t,{j:()=>m,db:()=>f});var r=s(3915),a=s(3004),n=s(5317),i=s(5594);let l=i.z.object({NEXT_PUBLIC_FIREBASE_API_KEY:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_PROJECT_ID:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_APP_ID:i.z.string().min(1)}),o={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyCXrvLqIa0uwEQ8HEnxu4qxrZ9zrvCcZr0",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"phishdefender-mfjms.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"phishdefender-mfjms",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"phishdefender-mfjms.appspot.com",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"636470351357",NEXT_PUBLIC_FIREBASE_APP_ID:"1:636470351357:web:29a13366a0b7e7038ff594"},d=l.safeParse(o);if(!d.success)throw console.error("Invalid client environment variables:",d.error.flatten().fieldErrors),Error("Invalid client environment variables.");let c={apiKey:o.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:o.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:o.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:o.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:o.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:o.NEXT_PUBLIC_FIREBASE_APP_ID},u=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)(c),m=(0,a.xI)(u),f=(0,n.aU)(u)},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var r=s(5155),a=s(2115),n=s(9434);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},5638:(e,t,s)=>{"use strict";s.d(t,{ThreatIntelClient:()=>U});var r=s(5155),a=s(2115),n=s(9434);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...a})})});i.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...a})});l.displayName="TableHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...a})});o.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});d.displayName="TableRow";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});c.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";var m=s(6695),f=s(2523),x=s(285),p=s(6126),h=s(1133),b=s(8376),g=s(7805),v=s(5300),N=s(4063),j=s(965),E=s(3158),_=s(5074),y=s(172),T=s(7481),I=s(2437),w=s(5317),S=s(7313),A=s(6102);function R(e){let{level:t}=e;return"High"===t?(0,r.jsxs)(p.E,{variant:"destructive",className:"gap-1",children:[(0,r.jsx)(h.A,{className:"h-3 w-3"})," High"]}):(0,r.jsxs)(p.E,{variant:"default",className:"bg-accent text-accent-foreground gap-1",children:[(0,r.jsx)(h.A,{className:"h-3 w-3"})," Medium"]})}function B(e){let{status:t}=e;return"Verified"===t?(0,r.jsxs)(p.E,{variant:"secondary",className:"gap-1 text-green-600",children:[(0,r.jsx)(b.A,{className:"h-3 w-3"})," Verified"]}):(0,r.jsx)(p.E,{variant:"secondary",children:t})}function C(e){let{type:t}=e,s={URL:{icon:(0,r.jsx)(g.A,{className:"h-3 w-3"}),label:"URL"},Email:{icon:(0,r.jsx)(v.A,{className:"h-3 w-3"}),label:"Email"},SMS:{icon:(0,r.jsx)(N.A,{className:"h-3 w-3"}),label:"SMS"}},{icon:a,label:n}=s[t]||s.URL;return(0,r.jsxs)(p.E,{variant:"outline",className:"gap-1",children:[a," ",n]})}function P(e){let{submissions:t}=e,[s,n]=(0,a.useState)(1);if(0===t.length)return(0,r.jsx)("div",{className:"text-center text-muted-foreground p-8",children:"No submissions found."});let m=Math.ceil(t.length/10),f=t.slice((s-1)*10,10*s);return(0,r.jsxs)(A.Bc,{children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(i,{children:[(0,r.jsx)(l,{children:(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{className:"w-[100px]",children:"Type"}),(0,r.jsx)(c,{children:"Content"}),(0,r.jsx)(c,{className:"hidden sm:table-cell",children:"Reported By"}),(0,r.jsx)(c,{className:"hidden md:table-cell",children:"Date"}),(0,r.jsx)(c,{children:"Risk"}),(0,r.jsx)(c,{children:"Status"})]})}),(0,r.jsx)(o,{children:f.map(e=>(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{children:(0,r.jsx)(C,{type:e.type})}),(0,r.jsx)(u,{children:(0,r.jsxs)(A.m_,{children:[(0,r.jsx)(A.k$,{asChild:!0,children:(0,r.jsx)("p",{className:"font-mono text-xs truncate max-w-[100px] sm:max-w-xs",children:e.content})}),(0,r.jsxs)(A.ZI,{align:"start",className:"max-w-md break-words",children:[(0,r.jsx)("pre",{className:"whitespace-pre-wrap font-mono text-xs",children:e.content}),e.comments&&(0,r.jsxs)("p",{className:"mt-2 pt-2 border-t text-muted-foreground",children:[(0,r.jsx)("b",{children:"Comments:"})," ",e.comments]})]})]})}),(0,r.jsx)(u,{className:"hidden sm:table-cell",children:e.reportedBy}),(0,r.jsx)(u,{className:"hidden md:table-cell",children:e.date}),(0,r.jsx)(u,{children:(0,r.jsx)(R,{level:e.riskLevel})}),(0,r.jsx)(u,{children:(0,r.jsx)(B,{status:e.status})})]},e.id))})]})}),m>1&&(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-2 p-4 border-t",children:[(0,r.jsxs)(x.$,{variant:"outline",size:"sm",onClick:()=>n(e=>Math.max(1,e-1)),disabled:1===s,children:[(0,r.jsx)(j.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Previous"})]}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",m]}),(0,r.jsxs)(x.$,{variant:"outline",size:"sm",onClick:()=>n(e=>Math.min(m,e+1)),disabled:s===m,children:[(0,r.jsx)(E.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Next"})]})]})]})}function U(){let{toast:e}=(0,T.dj)(),[t,s]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[l,o]=(0,a.useState)(""),[d,c]=(0,a.useState)("All");(0,a.useEffect)(()=>{let t=(0,w.P)((0,w.rJ)(I.db,"communitySubmissions"),(0,w.My)("createdAt","desc")),r=(0,w.aQ)(t,e=>{let t=[];e.forEach(e=>{var s,r;let a=e.data();t.push({id:e.id,type:a.type||"URL",content:a.content||a.url,comments:a.comments,reportedBy:a.reportedBy,date:null!=(r=null==(s=a.createdAt)?void 0:s.toDate().toISOString().split("T")[0])?r:new Date().toISOString().split("T")[0],riskLevel:a.riskLevel,status:a.status})}),s(t),i(!1)},t=>{console.error("Error fetching submissions:",t),e({variant:"destructive",title:"Error",description:"Could not load community feed."}),i(!1)});return()=>r()},[e]);let u=(0,a.useMemo)(()=>t.filter(e=>{let t="All"===d||e.type===d,s=e.content.toLowerCase().includes(l.toLowerCase());return t&&s}),[t,l,d]);return(0,r.jsxs)(m.Zp,{children:[(0,r.jsx)(m.aR,{children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(m.ZB,{children:"Community Reports"}),(0,r.jsx)(m.BT,{children:"Browse all threats reported by the community."})]}),(0,r.jsxs)("div",{className:"relative w-full sm:w-auto",children:[(0,r.jsx)(_.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(f.p,{type:"search",placeholder:"Search submissions...",className:"pl-8 w-full sm:w-[250px] md:w-[300px]",value:l,onChange:e=>o(e.target.value)})]})]})}),(0,r.jsx)(m.Wu,{className:"p-0",children:(0,r.jsxs)(S.Tabs,{defaultValue:"All",onValueChange:e=>c(e),className:"w-full",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(S.TabsList,{className:"px-4 sm:px-6 border-b w-full justify-start rounded-none",children:[(0,r.jsx)(S.TabsTrigger,{value:"All",children:"All"}),(0,r.jsxs)(S.TabsTrigger,{value:"URL",children:[(0,r.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"URLs"]}),(0,r.jsxs)(S.TabsTrigger,{value:"Email",children:[(0,r.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Emails"]}),(0,r.jsxs)(S.TabsTrigger,{value:"SMS",children:[(0,r.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"SMS"]})]})}),(0,r.jsx)("div",{className:"p-0",children:n?(0,r.jsx)("div",{className:"text-center p-8",children:(0,r.jsx)(y.A,{className:"mx-auto my-8 h-8 w-8 animate-spin text-primary"})}):(0,r.jsx)(P,{submissions:u})})]})})]})}},5748:(e,t,s)=>{Promise.resolve().then(s.bind(s,5638))},6102:(e,t,s)=>{"use strict";s.d(t,{Bc:()=>l,ZI:()=>c,k$:()=>d,m_:()=>o});var r=s(5155),a=s(2115),n=s(8082),i=s(9434);let l=n.Kq,o=n.bL,d=n.l9,c=a.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...l}=e;return(0,r.jsx)(n.UC,{ref:t,sideOffset:a,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})});c.displayName=n.UC.displayName},6126:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var r=s(5155);s(2115);var a=s(2085),n=s(9434);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},6695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var r=s(5155),a=s(2115),n=s(9434);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},7313:(e,t,s)=>{"use strict";s.d(t,{Tabs:()=>l,TabsContent:()=>c,TabsList:()=>o,TabsTrigger:()=>d});var r=s(5155),a=s(2115),n=s(704),i=s(9434);let l=n.bL,o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});o.displayName=n.B8.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:bg-accent/50",s),...a})});d.displayName=n.l9.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});c.displayName=n.UC.displayName},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m});var r=s(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(2596),a=s(9688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,416,277,950,443,623,301,111,441,684,358],()=>t(5748)),_N_E=e.O()}]);