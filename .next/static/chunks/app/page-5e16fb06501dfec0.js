(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{172:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2437:(e,r,t)=>{"use strict";t.d(r,{j:()=>d,db:()=>c});var a=t(3915),s=t(3004),n=t(5317),i=t(5594);let u=i.z.object({NEXT_PUBLIC_FIREBASE_API_KEY:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_PROJECT_ID:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:i.z.string().min(1),NEXT_PUBLIC_FIREBASE_APP_ID:i.z.string().min(1)}),o={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyCXrvLqIa0uwEQ8HEnxu4qxrZ9zrvCcZr0",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"phishdefender-mfjms.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"phishdefender-mfjms",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"phishdefender-mfjms.appspot.com",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"636470351357",NEXT_PUBLIC_FIREBASE_APP_ID:"1:636470351357:web:29a13366a0b7e7038ff594"},E=u.safeParse(o);if(!E.success)throw console.error("Invalid client environment variables:",E.error.flatten().fieldErrors),Error("Invalid client environment variables.");let l={apiKey:o.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:o.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:o.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:o.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:o.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:o.NEXT_PUBLIC_FIREBASE_APP_ID},_=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)(l),d=(0,s.xI)(_),c=(0,n.aU)(_)},3792:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var a=t(5155),s=t(8030),n=t(5695),i=t(2115),u=t(172);function o(){let{user:e,loading:r}=(0,s.A)(),t=(0,n.useRouter)();return(0,i.useEffect)(()=>{r||(e?t.replace("/dashboard/analyzer"):t.replace("/login"))},[e,r,t]),(0,a.jsxs)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ml-2",children:"Loading..."})]})}},5276:(e,r,t)=>{Promise.resolve().then(t.bind(t,3792))},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"notFound")&&t.d(r,{notFound:function(){return a.notFound}}),t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},8030:(e,r,t)=>{"use strict";t.d(r,{A:()=>_,AuthProvider:()=>l});var a=t(5155),s=t(2115),n=t(5695),i=t(3004),u=t(2437),o=t(5317);let E=(0,s.createContext)(void 0),l=e=>{let{children:r}=e,[t,l]=(0,s.useState)(null),[_,d]=(0,s.useState)(!1),[c,I]=(0,s.useState)(!0),m=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=(0,i.hg)(u.j,async e=>{l(e),e?d(!!(await (0,i.yx)(e)).claims.admin):d(!1),I(!1)});return()=>e()},[]);let A=e=>{console.error("Firebase Auth Error:",e);let r="An unknown authentication error occurred.";return"auth/email-already-in-use"===e.code?r="This email is already registered. Please sign in or use a different email.":"auth/invalid-credential"===e.code||"auth/wrong-password"===e.code||"auth/user-not-found"===e.code?r="Invalid credentials. Please check your email and password and try again.":e.message&&(r=e.message),{error:r}},h=async e=>{let r=(0,o.H9)(u.db,"users",e.uid);if((await (0,o.x7)(r)).exists())await (0,o.BN)(r,{lastLoginAt:(0,o.O5)()},{merge:!0});else{var t;await (0,o.BN)(r,{uid:e.uid,email:e.email,displayName:e.displayName,username:e.displayName||(null==(t=e.email)?void 0:t.split("@")[0])||"",photoURL:e.photoURL,phone:"",quizScores:{},contributions:{url:0,email:0,sms:0},readArticles:[],createdAt:(0,o.O5)(),lastLoginAt:(0,o.O5)()},{merge:!0})}},P=async()=>{let e=new i.HF;try{let r=await (0,i.df)(u.j,e);return await h(r.user),m.push("/"),{}}catch(e){return A(e)}},B=async(e,r)=>{try{let t=await (0,i.x9)(u.j,e,r);return await h(t.user),m.push("/"),{}}catch(e){return A(e)}},N=async(e,r)=>{try{let t=await (0,i.eJ)(u.j,e,r),a=e.split("@")[0];await (0,i.r7)(t.user,{displayName:a});let s={...t.user,displayName:a};return await h(s),m.push("/"),{}}catch(e){return A(e)}},p=async()=>{try{await (0,i.CI)(u.j),m.push("/login")}catch(e){console.error("Error signing out",e)}};return(0,a.jsx)(E.Provider,{value:{user:t,loading:c,isAdmin:_,signInWithGoogle:P,signOut:p,signInWithEmail:B,signUpWithEmail:N},children:r})},_=()=>{let e=(0,s.useContext)(E);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,416,950,441,684,358],()=>r(5276)),_N_E=e.O()}]);